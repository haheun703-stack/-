# ============================================================
# ğŸ§Š "ê¸°ëŒ€ê°€ ì‹ì€ ìë¦¬" v2.5 â€” ë“€ì–¼ íŠ¸ë¦¬ê±° ë°±í…ŒìŠ¤íŠ¸ ì„¤ì •
# ============================================================
# í•µì‹¬ ì² í•™ v2.5:
#   1. ì¡°ì •ì´ ëë‚˜ëŠ” ìë¦¬(Zone)ë¥¼ ë¨¼ì € ì°¾ëŠ”ë‹¤       â†’ BES ìŠ¤ì½”ì–´ë§
#   2. ì‹œë™ ì‹ í˜¸(Impulse)ì—ì„œ ì¼ë¶€ ì„ ì·¨í•œë‹¤          â†’ Trigger-1
#   3. í™•ì • ì‹ í˜¸(Confirm)ì—ì„œ ë¹„ì¤‘ì„ ëŠ˜ë¦°ë‹¤          â†’ Trigger-2
#   4. ê°€ì§œ ì‹œë™ì€ ì†ì ˆë¡œ ë¹„ìš© ì²˜ë¦¬í•œë‹¤              â†’ ëª¨ë“œë³„ ì†ì ˆ
#   5. ì†ìµë¹„ì™€ ìŠ¹ë¥ ì„ 'ëª¨ë“œë³„'ë¡œ ê´€ë¦¬í•œë‹¤           â†’ ë¶„ë¦¬ í†µê³„
# ============================================================

strategy:
  name: "cooled_zone_v2.5_dual"

  # === Pre-screening ===
  min_revenue_ì–µ: 1000
  min_daily_trading_value_ì–µ: 5
  min_consecutive_profit_quarters: 2

  # === ATR ì„¤ì • ===
  atr_period: 14
  atr_pullback_ranges:
    noise: [0, 1.0]        # 0.0ì 
    shallow: [1.0, 1.5]    # 0.4ì 
    healthy: [1.5, 2.0]    # 0.7ì 
    sweet_spot: [2.0, 2.5] # 1.0ì  â˜…
    deep: [2.5, 3.5]       # 0.7ì 
    structural: [3.5, 999] # 0.4ì 
  atr_stop_multiplier: 2.0
  atr_target_multiplier: 5.0

  # === ë°¸ë¥˜ì—ì´ì…˜ ===
  value_discount_threshold: 0.9
  eps_revision_lookback_months: 3
  forward_value_ranges:
    deep_discount: [0, 0.7]
    discount: [0.7, 0.9]
    fair: [0.9, 1.1]
    premium: [1.1, 1.3]
    expensive: [1.3, 999]

  # === ëª¨ë©˜í…€/ìˆ˜ê¸‰ ===
  rsi_period: 14
  rsi_sweet_spot: [38, 45]
  stoch_rsi_threshold: 25
  volume_ma_period: 20

  # === ì¶”ì„¸ í•„í„° ===
  sma_short: 60
  sma_long: 120
  sma_trend: 200
  adx_threshold: 20

  # === ë¶„ë°° ë¦¬ìŠ¤í¬ ===
  drs_max_threshold: 0.60
  drs_lookback: 20
  drs_weights:
    obv_slope: 0.30
    volume_pattern: 0.25
    institutional_flow: 0.25
    bounce_strength: 0.20

  # === BES ê°€ì¤‘ì¹˜ ===
  weights:
    atr_pullback: 0.35
    forward_value: 0.35
    supply_demand: 0.30

  # === ë“±ê¸‰ ê¸°ì¤€ ===
  grades:
    A: { min_bes: 0.85, position_ratio: 1.00 }
    B: { min_bes: 0.70, position_ratio: 0.67 }
    C: { min_bes: 0.55, position_ratio: 0.33 }

  # ============================================================
  # ğŸ”¥ 2ë‹¨ê³„ íŠ¸ë¦¬ê±° ì—”ì§„ (Impulse + Confirm)
  # ============================================================
  triggers:
    # â”€â”€ Trigger-1: ì‹œë™ íŠ¸ë¦¬ê±° (ê³µê²©í˜•, ê¸‰ë“± ì´ˆì… ì„ ì ) â”€â”€
    # 3ê°œ ì¡°ê±´ ì¤‘ 2ê°œ ì´ìƒ ì¶©ì¡± ì‹œ ë°œë™
    impulse:
      min_conditions: 2          # 3ê°œ ì¤‘ ìµœì†Œ ì¶©ì¡± ìˆ˜
      prev_high_breakout: true   # ì „ì¼ ê³ ê°€ ëŒíŒŒ ë§ˆê°
      volume_surge_mult: 1.5     # ê±°ë˜ëŸ‰ >= 20ì¼ í‰ê·  Ã— 1.5
      close_above_ma5: true      # ì¢…ê°€ > 5MA
      # ì¶”ê°€ í™•ì¸: Higher Low (ìµœê·¼ 2ê°œ ì €ì  ë¹„êµ)
      higher_low_check: true
      # ì‹œë™ íŠ¸ë¦¬ê±° ì „ìš© ë¦¬ìŠ¤í¬
      stop_loss_pct: 0.03        # -3% ì¦‰ì‹œ ì†ì ˆ (ê°€ì§œ ì‹œë™ ë¹ ë¥¸ ì»·)
      swing_low_stop: true       # ë˜ëŠ” ìŠ¤ìœ™ ì €ì  ì´íƒˆ ì‹œ ì¦‰ì‹œ ì»·

    # â”€â”€ Trigger-2: í™•ì¸ íŠ¸ë¦¬ê±° (ë³´ìˆ˜í˜•, ì•ˆì „ ì§„ì…) â”€â”€
    confirm:
      ma20_recovery_days: 2      # 20MA ìœ„ ë³µê·€ í›„ 2ì¼ ì—°ì† ìœ ì§€
      volume_maintain: true      # ê±°ë˜ëŸ‰ ì¦ê°€/ìœ ì§€
      no_new_low: true           # ì €ì  ê°±ì‹  ì—†ìŒ
      rsi_above: 50              # RSI > 50 íšŒë³µ
      # í™•ì¸ íŠ¸ë¦¬ê±° ì „ìš© ë¦¬ìŠ¤í¬
      stop_loss_pct: 0.05        # -5% ì†ì ˆ (í™•ì¸ í›„ ì§„ì…ì´ë¼ ì—¬ìœ )

    # â”€â”€ ë¶„í•  ë§¤ìˆ˜ ë¹„ì¤‘ â”€â”€
    staged_entry:
      stage1_impulse_pct: 0.40   # 1ì°¨: ì‹œë™ íŠ¸ë¦¬ê±° â†’ 40%
      stage2_confirm_pct: 0.40   # 2ì°¨: í™•ì¸ íŠ¸ë¦¬ê±° â†’ 40%
      stage3_breakout_pct: 0.20  # 3ì°¨: ì „ê³ ì  ëŒíŒŒ + ê±°ë˜ëŸ‰ 1.5ë°° â†’ 20%
      breakout_volume_mult: 1.5  # 3ì°¨ ì§„ì… ê±°ë˜ëŸ‰ ì¡°ê±´

  # ============================================================
  # ğŸ”¥ ë“€ì–¼ íŠ¸ë¦¬ê±° ì‹œìŠ¤í…œ (v2.5 ì‹ ê·œ)
  # ============================================================
  dual_trigger:
    enabled: true

    # â”€â”€ Trigger-1: ì‹œë™ íŠ¸ë¦¬ê±° (Impulse) â”€â”€
    trigger_1:
      name: "impulse"
      min_conditions: 2
      volume_surge_mult: 1.5
      higher_low_days: 3
      volume_contraction: 0.7
      lower_tail_ratio: 0.6
      stop_loss_atr_mult: 1.5    # íƒ€ì´íŠ¸ ì†ì ˆ
      target_atr_mult: 4.0
      position_pct: 0.40

    # â”€â”€ Trigger-2: í™•ì¸ íŠ¸ë¦¬ê±° (Confirm) â”€â”€
    trigger_2:
      name: "confirm"
      above_sma20_days: 2
      no_new_low_days: 5
      rsi_above: 50
      stop_loss_atr_mult: 2.0    # ì—¬ìœ  ì†ì ˆ
      target_atr_mult: 5.0
      position_pct: 0.40

    # â”€â”€ Trigger-3: ëŒíŒŒ ì¶”ê°€ (Breakout Add) â”€â”€
    trigger_3:
      name: "breakout_add"
      new_high_days: 10
      volume_surge_mult: 1.5
      stop_loss_atr_mult: 2.0
      target_atr_mult: 6.0
      position_pct: 0.20

# ============================================================
# ë°±í…ŒìŠ¤íŠ¸ ì„¤ì •
# ============================================================
backtest:
  start_date: "2019-01-01"
  end_date: "2024-12-31"
  initial_capital: 50000000
  max_risk_pct: 0.015
  max_positions: 4
  max_single_position_pct: 0.40
  max_portfolio_risk_pct: 0.06
  commission_rate: 0.0015
  slippage_rate: 0.001
  trailing_stop_atr_mult: 2.0
  partial_take_profit_pct: 0.50
  trend_exit_consecutive_days: 3

# ============================================================
# ì—…ì¢…ë³„ Forward PER ì°¸ê³  ë²”ìœ„
# ============================================================
sector_per:
  ë°˜ë„ì²´: 15.0
  ìë™ì°¨: 7.0
  ë°°í„°ë¦¬: 25.0
  ë°”ì´ì˜¤: 30.0
  ì€í–‰: 5.5
  ì¦ê¶Œ: 8.0
  í™”í•™: 10.0
  ì² ê°•: 6.0
  ìœ í†µ: 12.0
  IT: 18.0
  ê±´ì„¤: 7.0
  ì¡°ì„ : 12.0
  í†µì‹ : 10.0
  ì‹í’ˆ: 14.0
  ê¸°íƒ€: 11.0
