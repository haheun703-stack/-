# ============================================================
# "Quantum Master" v7.0 â€” 7-Layer Pipeline + Master Controller
# ============================================================
# v7.0 í•µì‹¬:
#   1. 7-Layer Signal Pipeline (ë ˆì§/OU/ëª¨ë©˜í…€/ìˆ˜ê¸‰ ê²Œì´íŠ¸)
#   2. 4ë‹¨ê³„ ë¶€ë¶„ì²­ì‚° (Price Action ë…¼ë¬¸: 2R/4R/8R/10R)
#   3. HMM ë ˆì§ ê°ì§€ (ë™ì  ì ì‘ ì „ëµ ë…¼ë¬¸)
#   4. OU í•„í„° (í‰ê· íšŒê·€ ì¢…ëª© ì„ ë³„)
#   5. Walk-Forward ê²€ì¦ (ê³¼ìµœì í™” ë°©ì§€)
#   6. TGCI ë…ë¦½ ìŠ¤ì½”ì–´ë§ (TRIX Golden Cross Indicator)
#   7. Master Controller ê°€ì¤‘ í•©ì‚° (ì„œë¸Œì‹œìŠ¤í…œ ì¢…í•© íŒì •)
# ============================================================

strategy:
  name: "quantum_master_v7.0"

  # === Pre-screening ===
  min_revenue_ì–µ: 1000
  min_daily_trading_value_ì–µ: 5
  min_consecutive_profit_quarters: 2

  # === ATR ì„¤ì • ===
  atr_period: 14
  atr_pullback_ranges:
    noise: [0, 1.0]        # 0.0ì 
    shallow: [1.0, 1.5]    # 0.4ì 
    healthy: [1.5, 2.0]    # 0.7ì 
    sweet_spot: [2.0, 2.5] # 1.0ì  â˜…
    deep: [2.5, 3.5]       # 0.7ì 
    structural: [3.5, 999] # 0.4ì 
  atr_stop_multiplier: 2.0
  atr_target_multiplier: 5.0

  # === ë°¸ë¥˜ì—ì´ì…˜ ===
  value_discount_threshold: 0.9
  eps_revision_lookback_months: 3
  forward_value_ranges:
    deep_discount: [0, 0.7]
    discount: [0.7, 0.9]
    fair: [0.9, 1.1]
    premium: [1.1, 1.3]
    expensive: [1.3, 999]

  # === ëª¨ë©˜í…€/ìˆ˜ê¸‰ ===
  rsi_period: 14
  rsi_sweet_spot: [38, 45]
  stoch_rsi_threshold: 25
  volume_ma_period: 20

  # === Dynamic RSI (ë³€ë™ì„± ì ì‘í˜• ê³¼ë§¤ë„ ê¸°ì¤€) ===
  # T = clip(base - k * (ATR/P_norm - 1), min, max)
  # ë³€ë™ì„± ë†’ìœ¼ë©´ ê¸°ì¤€ â†“ (ì—„ê²©), ë‚®ìœ¼ë©´ â†‘ (ê´€ëŒ€)
  dynamic_rsi:
    enabled: true
    base: 30                  # ê¸°ë³¸ ê³¼ë§¤ë„ ê¸°ì¤€
    min: 20                   # ìµœì†Œ (ê³ ë³€ë™ì„±)
    max: 40                   # ìµœëŒ€ (ì €ë³€ë™ì„±)
    k: 10                     # ë¯¼ê°ë„ ê³„ìˆ˜
    lookback: 60              # ATR/P ì •ê·œí™” ê¸°ê°„
    rsi_ema_period: 9         # RSI EMA (ë°˜ì „ í™•ì¸ìš©)

  # === ì¶”ì„¸ í•„í„° ===
  sma_short: 60
  sma_long: 120
  sma_trend: 200
  adx_threshold: 20

  # === ë¶„ë°° ë¦¬ìŠ¤í¬ ===
  drs_max_threshold: 0.60
  drs_lookback: 20
  drs_weights:
    obv_slope: 0.30
    volume_pattern: 0.25
    institutional_flow: 0.25
    bounce_strength: 0.20

  # === BES ê°€ì¤‘ì¹˜ ===
  weights:
    atr_pullback: 0.35
    forward_value: 0.35
    supply_demand: 0.30

  # === v6.4 Gate 4/5 (BES v2.2 íŒ¨ì¹˜) ===
  gates:
    atr_pullback_gate:
      enabled: true
      min_pullback_atr: 1.0          # ATR ì¡°ì •í­ >= 1.0 (ë…¸ì´ì¦ˆ ì°¨ë‹¨)
    high_52w_gate:
      enabled: true
      max_pct_of_52w_high: 0.95      # 52ì£¼ ìµœê³ ê°€ 95% ë¯¸ë§Œë§Œ í†µê³¼

  # === v6.4 Consensus Bonus (íŒ©í„° ìˆ˜ë ´ ë³´ë„ˆìŠ¤) ===
  consensus_bonus:
    enabled: true
    full_bonus_pct: 0.15             # 3íŒ©í„° ì „ë¶€ ì–‘í˜¸ â†’ +15%
    strong_bonus_pct: 0.08           # 2íŒ©í„° ì–‘í˜¸ â†’ +8%

  # === v6.4 í¬ë¬¼ì„  ì´ˆì  íƒì§€ ===
  focus_point:
    enabled: true
    lookback_days: 5                 # ì¶”ì„¸ ë¶„ì„ ê¸°ê°„
    min_rising_factors: 3            # ë™ì‹œ ìƒìŠ¹ í•„ìš” íŒ©í„° ìˆ˜

  # === ë“±ê¸‰ ê¸°ì¤€ ===
  min_entry_grade: "B"           # v7.1: Bë“±ê¸‰ ì´ìƒë§Œ ì§„ì… í—ˆìš© (Cë“±ê¸‰ ì°¨ë‹¨)
  grades:
    A: { min_bes: 0.85, position_ratio: 1.00 }
    B: { min_bes: 0.70, position_ratio: 0.67 }
    C: { min_bes: 0.55, position_ratio: 0.33 }

  # ============================================================
  # ğŸ”¥ 2ë‹¨ê³„ íŠ¸ë¦¬ê±° ì—”ì§„ (Impulse + Confirm)
  # ============================================================
  triggers:
    # â”€â”€ Trigger-1: ì‹œë™ íŠ¸ë¦¬ê±° (ê³µê²©í˜•, ê¸‰ë“± ì´ˆì… ì„ ì ) â”€â”€
    # 3ê°œ ì¡°ê±´ ì¤‘ 2ê°œ ì´ìƒ ì¶©ì¡± ì‹œ ë°œë™
    impulse:
      min_conditions: 2          # 3ê°œ ì¤‘ ìµœì†Œ ì¶©ì¡± ìˆ˜
      prev_high_breakout: true   # ì „ì¼ ê³ ê°€ ëŒíŒŒ ë§ˆê°
      volume_surge_mult: 1.5     # ê±°ë˜ëŸ‰ >= 20ì¼ í‰ê·  Ã— 1.5
      close_above_ma5: true      # ì¢…ê°€ > 5MA
      # ì¶”ê°€ í™•ì¸: Higher Low (ìµœê·¼ 2ê°œ ì €ì  ë¹„êµ)
      higher_low_check: true
      # ì‹œë™ íŠ¸ë¦¬ê±° ì „ìš© ë¦¬ìŠ¤í¬
      stop_loss_pct: 0.03        # -3% ì¦‰ì‹œ ì†ì ˆ (ê°€ì§œ ì‹œë™ ë¹ ë¥¸ ì»·)
      swing_low_stop: true       # ë˜ëŠ” ìŠ¤ìœ™ ì €ì  ì´íƒˆ ì‹œ ì¦‰ì‹œ ì»·

    # â”€â”€ Trigger-2: í™•ì¸ íŠ¸ë¦¬ê±° (ë³´ìˆ˜í˜•, ì•ˆì „ ì§„ì…) â”€â”€
    confirm:
      ma20_recovery_days: 2      # 20MA ìœ„ ë³µê·€ í›„ 2ì¼ ì—°ì† ìœ ì§€
      volume_maintain: true      # ê±°ë˜ëŸ‰ ì¦ê°€/ìœ ì§€
      no_new_low: true           # ì €ì  ê°±ì‹  ì—†ìŒ
      rsi_above: 50              # RSI > 50 íšŒë³µ
      # í™•ì¸ íŠ¸ë¦¬ê±° ì „ìš© ë¦¬ìŠ¤í¬
      stop_loss_pct: 0.05        # -5% ì†ì ˆ (í™•ì¸ í›„ ì§„ì…ì´ë¼ ì—¬ìœ )

    # â”€â”€ ë¶„í•  ë§¤ìˆ˜ ë¹„ì¤‘ â”€â”€
    staged_entry:
      stage1_impulse_pct: 0.40   # 1ì°¨: ì‹œë™ íŠ¸ë¦¬ê±° â†’ 40%
      stage2_confirm_pct: 0.40   # 2ì°¨: í™•ì¸ íŠ¸ë¦¬ê±° â†’ 40%
      stage3_breakout_pct: 0.20  # 3ì°¨: ì „ê³ ì  ëŒíŒŒ + ê±°ë˜ëŸ‰ 1.5ë°° â†’ 20%
      breakout_volume_mult: 1.5  # 3ì°¨ ì§„ì… ê±°ë˜ëŸ‰ ì¡°ê±´

  # ============================================================
  # ğŸ”¥ ë“€ì–¼ íŠ¸ë¦¬ê±° ì‹œìŠ¤í…œ (v2.5 ì‹ ê·œ)
  # ============================================================
  dual_trigger:
    enabled: true

    # â”€â”€ Trigger-1: ì‹œë™ íŠ¸ë¦¬ê±° (Impulse) â”€â”€
    trigger_1:
      name: "impulse"
      min_conditions: 2
      volume_surge_mult: 1.5
      higher_low_days: 3
      volume_contraction: 0.7
      lower_tail_ratio: 0.6
      stop_loss_atr_mult: 1.5    # íƒ€ì´íŠ¸ ì†ì ˆ
      target_atr_mult: 4.0
      position_pct: 0.40

    # â”€â”€ Trigger-2: í™•ì¸ íŠ¸ë¦¬ê±° (Confirm) â”€â”€
    trigger_2:
      name: "confirm"
      above_sma20_days: 2
      no_new_low_days: 5
      rsi_above: 50
      stop_loss_atr_mult: 2.0    # ì—¬ìœ  ì†ì ˆ
      target_atr_mult: 5.0
      position_pct: 0.40

    # â”€â”€ Trigger-3: ëŒíŒŒ ì¶”ê°€ (Breakout Add) â”€â”€
    trigger_3:
      name: "breakout_add"
      new_high_days: 10
      volume_surge_mult: 1.5
      stop_loss_atr_mult: 2.0
      target_atr_mult: 6.0
      position_pct: 0.20

    # â”€â”€ Trigger-4: ì¶”ì„¸ ì§€ì† (Trend Continuation) â”€â”€
    # Grade F ìš°íšŒ: MA20 ìœ„ì—ì„œ ê°•í•œ ìƒìŠ¹ ì¶”ì„¸ê°€ í™•ì¸ë˜ë©´ ë³´ìˆ˜ì  ì§„ì… í—ˆìš©
    trend_continuation:
      enabled: true
      min_conditions: 5            # 7ê°œ ì¤‘ ìµœì†Œ ì¶©ì¡± ìˆ˜
      # --- ì¡°ê±´ ---
      adx_min: 25                  # ADX >= 25 (ê°•í•œ ì¶”ì„¸)
      rsi_range: [50, 72]          # RSI 50~72 (ê³¼ë§¤ìˆ˜ ì§ì „ê¹Œì§€)
      macd_above_signal: true      # MACD > Signal (ëª¨ë©˜í…€ ìœ ì§€)
      volume_min_ratio: 0.8        # ê±°ë˜ëŸ‰ >= 20ì¼í‰ê·  x 0.8
      obv_rising_days: 5           # OBV 5ì¼ ë³€í™” > 0
      price_above_ma60: true       # ì¢…ê°€ > MA60 (ì¤‘ê¸° ì¶”ì„¸)
      plus_di_above_minus: true    # +DI > -DI (ë°©í–¥ì„±)
      # --- ë¦¬ìŠ¤í¬ (ë³´ìˆ˜ì ) ---
      stop_loss_pct: 0.03          # -3% íƒ€ì´íŠ¸ ì†ì ˆ
      target_atr_mult: 3.0         # ëª©í‘œ ATR x 3 (í’€ë°±ë³´ë‹¤ ë³´ìˆ˜ì )
      position_pct: 0.50           # ì •ìƒ ëŒ€ë¹„ 50% ë¹„ì¤‘
      max_rsi: 72                  # RSI 72 ì´ˆê³¼ ì‹œ ì§„ì… ê¸ˆì§€ (ê³¼ë§¤ìˆ˜)

# ============================================================
# v3.0 Quant Engine (ë…¼ë¬¸ ê¸°ë°˜ íŒŒë¼ë¯¸í„°)
# ============================================================
quant_engine:
  # â”€â”€ HMM ë ˆì§ ê°ì§€ (ë™ì  ì ì‘ ì „ëµ ë…¼ë¬¸) â”€â”€
  regime:
    n_states: 3
    p_accum_entry: 0.40        # Accumulation í™•ë¥  ìµœì†Œ 40%
    features: ["ret1", "ATR_pct", "vol_z", "smart_z"]

  # â”€â”€ OU í”„ë¡œì„¸ìŠ¤ í•„í„° (OU+BB ë…¼ë¬¸) â”€â”€
  ou:
    window: 60
    z_entry: -0.8              # OU z-score ì§„ì… (v7.1: -1.2â†’-0.8 ì™„í™”, ë” ë„“ì€ ì§„ì… êµ¬ê°„)
    half_life_min: 2           # ìµœì†Œ ë°˜ê°ê¸° (ì¼)
    half_life_max: 50          # ìµœëŒ€ ë°˜ê°ê¸° (v7.1: 25â†’50 ì™„í™”, ëŠë¦° íšŒê·€ë„ í—ˆìš©)
    snr_min: 0.08              # Signal-to-Noise (v7.1: 0.15â†’0.08 ì™„í™”)

  # â”€â”€ ëª¨ë©˜í…€ ë ˆì´ì–´ â”€â”€
  momentum:
    vol_surge_min: 1.2         # ê±°ë˜ëŸ‰ ì„œì§€ ìµœì†Œ ë°°ìˆ˜
    slope_ma60_min: -0.5       # MA60 ê¸°ìš¸ê¸° ìµœì†Œ (%)

  # â”€â”€ Smart Money (ì°¸ì¡° ì½”ë“œ) â”€â”€
  smart_money:
    foreign_weight: 0.6
    inst_weight: 0.4
    rolling_sum: 3
    ma_period: 60
    min_smart_z: 0.0           # Smart Z ìµœì†Œ

  # â”€â”€ 4ë‹¨ê³„ ë¶€ë¶„ì²­ì‚° (Price Action ë…¼ë¬¸) â”€â”€
  exit:
    partial_exit_r: [2, 4, 8, 10]    # Rë°°ìˆ˜ ëª©í‘œ (25%ì”©)
    partial_exit_pct: 0.25           # ê° ë‹¨ê³„ ì²­ì‚° ë¹„ìœ¨
    max_hold_days: 20                # ìµœëŒ€ ë³´ìœ ì¼ (ì‚¬ìš©ì ì„¤ì •: 20ì¼)
    trailing_stop_after_partial: true

  # â”€â”€ v4.5 Rolling Probability Gate (Adaptive Strategy) â”€â”€
  probability_model:
    enabled: true
    rolling_window: 200          # 200ì¼ ë¡¤ë§ ìœˆë„ìš°
    threshold: 0.65              # ì„±ê³µ í™•ë¥  >= 65% í†µê³¼
    lookahead_bars: 12           # 12ì¼ê°„ í‰ê·  ìˆ˜ìµë¥  ê¸°ì¤€
    min_avg_return: 0.01         # 1% ì´ìƒì´ë©´ "ì„±ê³µ"

  # â”€â”€ Walk-Forward ê²€ì¦ (ë°ì´í„° ìŠ¤ëˆ„í•‘ ë…¼ë¬¸) â”€â”€
  walk_forward:
    train_days: 504            # 2ë…„
    test_days: 126             # 6ê°œì›”
    step_days: 126             # 6ê°œì›”ì”© ì´ë™

  # â”€â”€ v4.5 Bootstrap ê²€ì¦ (Adaptive Strategy) â”€â”€
  bootstrap:
    enabled: true
    n_iterations: 1000           # Bootstrap ë°˜ë³µ íšŸìˆ˜
    block_size: 10               # Block Bootstrap ë¸”ë¡ í¬ê¸°
    seed: 42                     # ì¬í˜„ì„± ì‹œë“œ
    metrics: ["sharpe", "total_return", "win_rate"]

  # â”€â”€ v4.6 Monte Carlo ì‹œë®¬ë ˆì´ì…˜ â”€â”€
  monte_carlo:
    enabled: true
    n_simulations: 1000          # ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜
    ruin_threshold_pct: -50.0    # íŒŒì‚° ì„ê³„ê°’ (ìë³¸ -50%)
    seed: 42                     # ì¬í˜„ì„± ì‹œë“œ

# ============================================================
# ë°±í…ŒìŠ¤íŠ¸ ì„¤ì •
# ============================================================
backtest:
  start_date: "2019-01-01"
  end_date: "2026-02-14"
  initial_capital: 30000000      # 3ì²œë§Œì› (ì‚¬ìš©ì ì„¤ì •)
  max_risk_pct: 0.02             # v8.1: 1.5%â†’2.0% (ê· í˜• ìµœì )
  max_positions: 5               # v8.1: 4â†’5 (ë™ì‹œ í¬ì§€ì…˜ í™•ëŒ€)
  max_single_position_pct: 0.40
  max_portfolio_risk_pct: 0.08   # v8.1: 6%â†’8% (ê· í˜• ìµœì )
  # ê±°ë˜ ë¹„ìš© (í˜„ì‹¤ ë°˜ì˜ v8.2)
  commission_rate: 0.00015      # ìˆ˜ìˆ˜ë£Œ 0.015% (ë§¤ìˆ˜+ë§¤ë„ ê°ê°, ì˜¨ë¼ì¸ í• ì¸ ì¦ê¶Œì‚¬)
  slippage_rate: 0.001          # ìŠ¬ë¦¬í”¼ì§€ 0.10% (ê¸°ë³¸, ì €ê°€ì£¼ëŠ” ë™ì  ì¦ê°€)
  tax_rate: 0.0018              # ì¦ê¶Œê±°ë˜ì„¸ 0.18% (ë§¤ë„ ì‹œë§Œ, 2025ë…„ ê¸°ì¤€)
  dynamic_slippage: true        # ì €ê°€ì£¼ ë™ì  ìŠ¬ë¦¬í”¼ì§€ (ê°€ê²© ì—­ë¹„ë¡€)
  slippage_price_ref: 10000     # ê¸°ì¤€ê°€ 1ë§Œì› (ì´í•˜ ìŠ¬ë¦¬í”¼ì§€ ì¦ê°€)
  trailing_stop_atr_mult: 2.0
  partial_take_profit_pct: 0.50
  trend_exit_consecutive_days: 3

# ============================================================
# ì—…ì¢…ë³„ Forward PER ì°¸ê³  ë²”ìœ„
# ============================================================
sector_per:
  ë°˜ë„ì²´: 15.0
  ìë™ì°¨: 7.0
  ë°°í„°ë¦¬: 25.0
  ë°”ì´ì˜¤: 30.0
  ì€í–‰: 5.5
  ì¦ê¶Œ: 8.0
  í™”í•™: 10.0
  ì² ê°•: 6.0
  ìœ í†µ: 12.0
  IT: 18.0
  ê±´ì„¤: 7.0
  ì¡°ì„ : 12.0
  í†µì‹ : 10.0
  ì‹í’ˆ: 14.0
  ê¸°íƒ€: 11.0

# ============================================================
# v4.5 ì„¹í„° ë¶„ë¥˜ ì²´ê³„ (Adaptive Strategy â€” 15ê°œ ì„¹í„°)
# ============================================================
sector_classification:
  enabled: true
  max_per_sector: 1               # ë™ì¼ ì„¹í„° ìµœëŒ€ 1ì¢…ëª© (ë¶„ì‚° íˆ¬ì)

  # 15ê°œ ì„¹í„° ì •ì˜ + ëŒ€í‘œ í‚¤ì›Œë“œ/ì—…ì¢…ëª… ë§¤í•‘
  # ì¢…ëª©ì˜ ì—…ì¢…ëª…ì´ keywords ì¤‘ í•˜ë‚˜ë¥¼ í¬í•¨í•˜ë©´ í•´ë‹¹ ì„¹í„°ë¡œ ë¶„ë¥˜
  sectors:
    ë°˜ë„ì²´:
      keywords: ["ë°˜ë„ì²´", "ë©”ëª¨ë¦¬", "íŒŒìš´ë“œë¦¬", "íŒ¹ë¦¬ìŠ¤"]
    ìë™ì°¨:
      keywords: ["ìë™ì°¨", "ì™„ì„±ì°¨", "ìë™ì°¨ë¶€í’ˆ"]
    ë°°í„°ë¦¬:
      keywords: ["ë°°í„°ë¦¬", "2ì°¨ì „ì§€", "ì´ì°¨ì „ì§€", "ì–‘ê·¹ì¬", "ìŒê·¹ì¬", "ì „í•´ì§ˆ", "ë¶„ë¦¬ë§‰"]
    ë°”ì´ì˜¤:
      keywords: ["ë°”ì´ì˜¤", "ì œì•½", "ì˜ì•½", "ì‹ ì•½", "ì§„ë‹¨"]
    ê¸ˆìœµ:
      keywords: ["ì€í–‰", "ì¦ê¶Œ", "ë³´í—˜", "ê¸ˆìœµ", "ìºí”¼íƒˆ", "ì¹´ë“œ"]
    í™”í•™:
      keywords: ["í™”í•™", "ì„ìœ í™”í•™", "ì •ìœ ", "í™”í•™ë¬¼ì§ˆ"]
    ì² ê°•ê¸ˆì†:
      keywords: ["ì² ê°•", "ë¹„ì² ê¸ˆì†", "ê¸ˆì†", "ì•Œë£¨ë¯¸ëŠ„"]
    ìœ í†µì†Œë¹„:
      keywords: ["ìœ í†µ", "ë°±í™”ì ", "ë©´ì„¸", "ì—¬í–‰", "í•­ê³µ", "í˜¸í…”", "ìŒì‹ë£Œ", "ì‹í’ˆ"]
    IT_SW:
      keywords: ["ì†Œí”„íŠ¸ì›¨ì–´", "ITì„œë¹„ìŠ¤", "í´ë¼ìš°ë“œ", "SaaS", "í”Œë«í¼", "ê²Œì„", "ì¸í„°ë„·"]
    IT_HW:
      keywords: ["ì „ìë¶€í’ˆ", "ë””ìŠ¤í”Œë ˆì´", "í†µì‹ ì¥ë¹„", "ê´‘í•™", "LED", "PCB"]
    ê±´ì„¤:
      keywords: ["ê±´ì„¤", "í† ëª©", "ê±´ì¶•", "ì‹œë©˜íŠ¸", "ë ˆë¯¸ì½˜"]
    ì¡°ì„ í•´ìš´:
      keywords: ["ì¡°ì„ ", "í•´ìš´", "ì„ ë°•"]
    í†µì‹ ë¯¸ë””ì–´:
      keywords: ["í†µì‹ ", "ë¯¸ë””ì–´", "ë°©ì†¡", "ì—”í„°í…Œì¸ë¨¼íŠ¸", "ì½˜í…ì¸ "]
    ì—ë„ˆì§€:
      keywords: ["ì „ë ¥", "ê°€ìŠ¤", "ì—ë„ˆì§€", "íƒœì–‘ê´‘", "í’ë ¥", "ì‹ ì¬ìƒ"]
    ê¸°íƒ€:
      keywords: []                # ì–´ë””ì—ë„ ë§¤ì¹­ ì•ˆ ë˜ë©´ ê¸°íƒ€

  # ì„¹í„°ë³„ ë¹„ì¤‘ ë°°ë¶„ (Adaptive Strategy)
  allocation:
    best: 0.45                    # 1ìˆœìœ„ ì¢…ëª©
    reserve1: 0.30                # 2ìˆœìœ„ ì¢…ëª©
    reserve2: 0.25                # 3ìˆœìœ„ ì¢…ëª©

# ============================================================
# v3.1 News Gate (L-1 ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ë ˆì´ì–´)
# ============================================================
news_gate:
  enabled: true
  version: "v3.2"

  # â”€â”€ v3.2 ë‰´ìŠ¤ ìŠ¤ì½”ì–´ ë¶€ìŠ¤íŠ¸ (Zone Score ê°€ì‚°) â”€â”€
  score_boost:
    grade_a: 0.15              # Aê¸‰ í™•ì • ê³µì‹œ â†’ +0.15
    grade_b: 0.08              # Bê¸‰ ì‹ ë¢° ë£¨ë¨¸ â†’ +0.08
    living_issue_high: 0.05    # ê³ ì˜í–¥(8+) ì‚´ì•„ìˆëŠ” ì´ìŠˆ â†’ +0.05/ê±´
    living_issue_normal: 0.03  # ì¤‘ì˜í–¥(5~7) ì‚´ì•„ìˆëŠ” ì´ìŠˆ â†’ +0.03/ê±´
    earnings_beat: 0.08        # ì–´ë‹ ì„œí”„ë¼ì´ì¦ˆ ì˜ˆìƒ(beat) â†’ +0.08
    earnings_growth: 0.05      # ê³ ì„±ì¥(YoY 20%+) in_line â†’ +0.05
    pre_earnings_window: 0.05  # ì‹¤ì  ë°œí‘œ 30ì¼ ì´ë‚´ â†’ +0.05
    positive_cluster: 0.03     # ê¸ì • ë‰´ìŠ¤ 3ê±´+ â†’ +0.03
    max_boost: 0.30            # ìµœëŒ€ ë¶€ìŠ¤íŠ¸ í•œë„

  # â”€â”€ ë‰´ìŠ¤ ë¶€ìŠ¤íŠ¸ + Trend Continuation ì—°ë™ â”€â”€
  trend_cont_integration:
    boost_threshold_relax: 0.08   # ì´ ë¶€ìŠ¤íŠ¸ ì´ìƒì´ë©´ TC min_conditions -1
    boost_threshold_ratio_up: 0.10 # ì´ ë¶€ìŠ¤íŠ¸ ì´ìƒì´ë©´ TC ë¹„ì¤‘ x1.4
    boost_threshold_rr_relax: 0.10 # ì´ ë¶€ìŠ¤íŠ¸ ì´ìƒì´ë©´ TC RR 1.2â†’1.0

  # â”€â”€ Aë“±ê¸‰: í™•ì • ê³µì‹œ â†’ íŒŒë¼ë¯¸í„° ì¡°ì • í›„ ì¦‰ì‹œ í•„í„° â”€â”€
  grade_a:
    rr_min: 1.2                    # ì†ìµë¹„ 1.7 â†’ 1.2ë¡œ ì™„í™”
    rsi_entry_max: 65              # RSI 70 â†’ 65ë¡œ ì™„í™”
    position_size_pct: 3           # ëŒ€í˜•ì£¼ 3%
    position_size_pct_small_cap: 2 # ì†Œí˜•ì£¼ 2%
    max_gap_up_pct: 15             # ê°­ì—… 15% ì´ìƒ ì¶”ê²© ê¸ˆì§€
    max_hold_days: 3               # ì´ë²¤íŠ¸ í¬ì§€ì…˜ ìµœëŒ€ 3ì¼
    settlement_strength_floor: 95  # ì²´ê²°ê°•ë„ 95 ë¯¸ë§Œ ì‹œ ì²­ì‚°
    max_concurrent_positions: 2    # ë™ì‹œ ì´ë²¤íŠ¸ í¬ì§€ì…˜ 2ê°œ ì´í•˜

  # â”€â”€ Bë“±ê¸‰: ë£¨ë¨¸/ë¯¸í™•ì¸ â†’ ê´€ì°° ë¦¬ìŠ¤íŠ¸ â”€â”€
  grade_b:
    action: "watchlist"
    monitor_days: 14
    upgrade_trigger: "grade_a"     # í™•ì • ì‹œ Aë“±ê¸‰ ìŠ¹ê²©

  # â”€â”€ Cë“±ê¸‰: ì¶”ì¸¡/í…Œë§ˆ â†’ ë¬´ì‹œ â”€â”€
  grade_c:
    action: "ignore"

  # â”€â”€ ëª©í‘œê°€ ê³„ì‚° â”€â”€
  target:
    target_1_rr: 1.0               # ë°˜ìµ (RR 1:1)
    target_2_rr: 2.0               # ì „ëŸ‰ ì²­ì‚° (RR 1:2)
    stop_loss_method: "atr"        # atr / fixed_pct
    stop_loss_atr_mult: 1.5

# ============================================================
# v3.1 Smart Money v2 (ë§¤ì§‘ 3ë‹¨ê³„ + OBV ë‹¤ì´ë²„ì „ìŠ¤)
# ============================================================
smart_money_v2:
  # â”€â”€ ë§¤ì§‘ ë‹¨ê³„ ì„ê³„ê°’ â”€â”€
  inst_net_buy_days: 5             # ê¸°ê´€ ìˆœë§¤ìˆ˜ ìµœì†Œ ì—°ì†ì¼ (Phase2)
  foreign_net_buy_days: 5          # ì™¸êµ­ì¸ ìˆœë§¤ìˆ˜ ìµœì†Œ ì—°ì†ì¼ (Phase2)
  inst_net_buy_strong_days: 10     # ê¸°ê´€+ì™¸êµ­ì¸ ë™ì‹œ ìˆœë§¤ìˆ˜ (Phase3)
  phase3_vol_ratio: 3.0            # Phase3 ê±°ë˜ëŸ‰ í­ë°œ ë°°ìˆ˜
  ma120_support_buffer: 0.03       # 120MA ì§€ì§€ í™•ì¸ ë²„í¼ (3%)

  # â”€â”€ OBV ë‹¤ì´ë²„ì „ìŠ¤ â”€â”€
  obv_divergence_lookback: 30      # ë‹¤ì´ë²„ì „ìŠ¤ ìŠ¤ìº” ê¸°ê°„ (ì¼)
  obv_slope_threshold: 0.0         # ê¸°ìš¸ê¸° íŒì • ìµœì†Œê°’

  # â”€â”€ SmartZ ì ìˆ˜ ê°€ê° â”€â”€
  bonus_phase1: 5                  # Phase1 (ì´ˆê¸° ë§¤ì§‘): +5
  bonus_phase2: 10                 # Phase2 (ì¤‘ê¸° ë§¤ì§‘): +10
  bonus_phase3: 15                 # Phase3 (ì í™”): +15
  penalty_dump: -20                # íˆ¬ë§¤ ê°ì§€: -20
  penalty_mild: -10                # ê²½ë¯¸í•œ ì´íƒˆ: -10

# ============================================================
# v4.1 ì ì‘í˜• ì²­ì‚° ì‹œìŠ¤í…œ (Adaptive Exit)
# ============================================================
# ë¬¸ì œ: Impulse -3% ê³ ì • ì†ì ˆì´ ê±´ê°•í•œ ì¡°ì •ë„ ì˜ë¼ë²„ë¦¼
# í•´ê²°: ì¡°ì • ê±´ê°•ë„ í‰ê°€ â†’ ë™ì  ì†ì ˆ ì¡°ì •
adaptive_exit:
  enabled: true

  # â”€â”€ ì¡°ì • ê±´ê°•ë„ ë°°ì  (ì´ 100ì ) â”€â”€
  weight_ma20_support: 15       # MA20 ì§€ì§€
  weight_ma60_support: 10       # MA60 ì§€ì§€
  weight_adx_trending: 12       # ADX >= 25
  weight_di_positive: 10        # +DI > -DI
  weight_obv_intact: 15         # OBV ìœ ì§€/ìƒìŠ¹
  weight_volume_declining: 10   # ê±°ë˜ëŸ‰ ê°ì†Œ
  weight_inst_flow: 8           # ê¸°ê´€ ìˆ˜ê¸‰
  weight_foreign_flow: 8        # ì™¸êµ­ì¸ ìˆ˜ê¸‰
  weight_rsi_healthy: 7         # RSI 30~70
  weight_pullback_depth: 5      # ì¡°ì • ê¹Šì´

  # â”€â”€ ë¶„ë¥˜ ì„ê³„ê°’ â”€â”€
  healthy_threshold: 65         # >= 65: ê±´ê°•í•œ ì¡°ì • â†’ ì†ì ˆ ì™„í™”
  caution_threshold: 40         # >= 40: ì£¼ì˜ â†’ í˜„í–‰ ìœ ì§€
  dangerous_threshold: 25       # >= 25: ìœ„í—˜ â†’ ì¦‰ì‹œ ì²­ì‚°
  # < 25: ê¸´ê¸‰ â†’ ì‹œì¥ê°€ ì²­ì‚°

  # â”€â”€ ì ì‘í˜• ì†ì ˆ íŒŒë¼ë¯¸í„° â”€â”€
  healthy_stop_mult: 2.0        # ê±´ê°•: ATR*2 ê¸°ë°˜ ë„“ì€ ì†ì ˆ
  caution_stop_mult: 1.5        # ì£¼ì˜: ATR*1.5
  dangerous_stop_pct: 0.02      # ìœ„í—˜: -2% íƒ€ì´íŠ¸
  ma20_stop_buffer: 0.015       # MA20 ì•„ë˜ 1.5% ë²„í¼
  max_healthy_pullback_pct: 0.08  # ê±´ê°•í•œ ì¡°ì • ìµœëŒ€ í—ˆìš© -8%

# ============================================================
# v4.1 ì¼ì¼ ë³´ìœ  ì ìˆ˜ (Daily Hold Scorer)
# ============================================================
daily_hold_scorer:
  enabled: true

  # â”€â”€ íŒë‹¨ ì„ê³„ê°’ â”€â”€
  strong_hold_threshold: 70     # >= 70: ê°•ë ¥ ë³´ìœ 
  hold_threshold: 50            # >= 50: ë³´ìœ  ìœ ì§€
  tighten_threshold: 30         # >= 30: ê²½ê³„ (ì†ì ˆ ê°•í™”)
  # < 30: ì²­ì‚°

  # â”€â”€ strong_hold ì‹œ íŒŒë¼ë¯¸í„° ì¡°ì • â”€â”€
  strong_hold_stop_mult: 1.5    # ì†ì ˆ 1.5ë°° ì™„í™”
  strong_hold_days_bonus: 5     # ë³´ìœ ì¼ +5ì¼ ì—°ì¥
  strong_hold_trailing_mult: 1.3  # íŠ¸ë ˆì¼ë§ 1.3ë°° ë„“ê²Œ

  # â”€â”€ tighten ì‹œ íŒŒë¼ë¯¸í„° ì¡°ì • â”€â”€
  tighten_stop_mult: 0.6        # ì†ì ˆ 0.6ë°° ê°•í™”
  tighten_trailing_mult: 0.7    # íŠ¸ë ˆì¼ë§ 0.7ë°° íƒ€ì´íŠ¸

# ============================================================
# v4.0 ë¼ì´ë¸Œ íŠ¸ë ˆì´ë”© ì„¤ì •
# ============================================================
live_trading:
  enabled: false                    # trueë¡œ ë³€ê²½ ì‹œ ì‹¤ì£¼ë¬¸ í™œì„±í™”
  mode: "paper"                     # "paper" (ëª¨ì˜) / "real" (ì‹¤ì „)

  # ì¼ì¼ ìŠ¤ì¼€ì¤„ (KST)
  schedule:
    daily_reset: "00:00"
    macro_collect: "07:00"
    news_briefing: "07:10"
    trade_prep: "08:20"
    buy_execution: "09:02"
    monitor_start: "09:10"
    monitor_end: "15:20"
    sell_execution: "15:25"
    close_pipeline: "15:35"

  # ì£¼ë¬¸ ì„¤ì •
  order:
    default_type: "limit"           # limit / market
    slippage_ticks: 2               # ì§€ì •ê°€ ìŠ¬ë¦¬í”¼ì§€ (2í‹± ìœ„/ì•„ë˜)
    max_retry: 3                    # ì£¼ë¬¸ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„
    retry_delay_sec: 5
    cancel_unfilled_after_sec: 300  # 5ë¶„ ë¯¸ì²´ê²° ì‹œ ì·¨ì†Œ

  # í¬ì§€ì…˜ ì œí•œ
  position:
    max_positions: 4
    max_single_pct: 0.40            # ë‹¨ì¼ ì¢…ëª© ìµœëŒ€ 40%
    max_portfolio_risk_pct: 0.06
    initial_capital: 30000000       # 3ì²œë§Œì› (ì‚¬ìš©ì ì„¤ì •)

  # ì•ˆì „ì¥ì¹˜
  safety:
    max_daily_loss_pct: -0.03       # ì¼ì¼ -3% ë§¤ë§¤ ì¤‘ë‹¨
    max_total_loss_pct: -0.10       # ì´ -10% ê¸´ê¸‰ ì²­ì‚°
    stop_signal_file: "STOP.signal"
    reboot_trigger_file: "reboot.trigger"
    emergency_sell_type: "market"   # ê¸´ê¸‰ ì²­ì‚°ì€ ì‹œì¥ê°€

  # ëª¨ë‹ˆí„°ë§
  monitor:
    interval_sec: 60                # 1ë¶„ ê°„ê²©
    trailing_check: true
    partial_exit_check: true
    kis_sync_interval_sec: 1800     # 30ë¶„ë§ˆë‹¤ KIS ì‹¤ì”ê³  ë™ê¸°í™”
    forced_liquidation_before: "15:15"  # ë§Œê¸°(max_hold_days) ë„ë˜ ì¢…ëª© ì¥ ë§ˆê° ì „ ê°•ì œì²­ì‚°

  # ì£¼ê°„ ë³´ê³ 
  weekly_report:
    enabled: true
    day: "friday"                   # ê¸ˆìš”ì¼ ì¥ë§ˆê° í›„ ì£¼ê°„ ì„±ê³¼ í…”ë ˆê·¸ë¨ ë°œì†¡

# ============================================================
# v4.7 ê¸°í•˜í•™ì  í€€íŠ¸ ë³´ì¡° ë ˆì´ì–´ (L7 Geometric v2.0)
# ============================================================
# 10ì§€í‘œ Ã— 7í”„ë¡œíŒŒì¼ ì²´ì œ. Approach A/B/C 3ê³„ì¸µ.
# ê¸°ì¡´ íŒŒì´í”„ë¼ì¸ì˜ ë³´ì¡° í™•ì¸ ë ˆì´ì–´ë¡œ ì‚¬ìš©.
geometric_engine:
  enabled: true
  profile: "default"                # default/reversal/breakout/capitulation/bull/bear/sideways

  # â”€â”€ Approach A: êµ¬ì¡°ì  íŒ¨í„´ â”€â”€
  harmonic_tolerance: 0.03          # í”¼ë³´ë‚˜ì¹˜ ë¹„ìœ¨ í—ˆìš© ì˜¤ì°¨ (3%)
  zigzag_pct: 3.0                   # ZigZag ì „í™˜ ê¸°ì¤€ (%)
  min_bars: 5                       # í”¼ë²— ê°„ ìµœì†Œ ë´‰ ìˆ˜
  elliott_zigzag_pct: 3.0           # ì—˜ë¦¬ì–´íŠ¸ìš© ZigZag
  elliott_min_bars: 3               # ì—˜ë¦¬ì–´íŠ¸ìš© ìµœì†Œ ë´‰ ìˆ˜
  slope_periods: [5, 10, 20, 60]    # ê°ë„ ë¶„ì„ ê¸°ê°„ ë¦¬ìŠ¤íŠ¸

  # â”€â”€ Approach B: ì—ë„ˆì§€ ìˆ˜ë ´ â”€â”€
  squeeze:
    bb_period: 20
    bb_std: 2.0
    kc_period: 20
    kc_mult: 1.5

  curvature:
    ema_span: 20
    window: 10

  confluence:
    zigzag_pct: 5.0
    bin_pct: 0.5
    min_count: 3

  # â”€â”€ Approach C: ê·¹ë‹¨ íšŒê·€ â”€â”€
  mean_reversion:
    periods: [20, 60, 120]

  volume_climax:
    spike_mult: 3.0
    exhaust_bars: 5

  band_breach:
    bb_period: 20
    bb_std: 2.0
    lookback: 25

  # â”€â”€ L7 ë³´ì¡° ë ˆì´ì–´ íŒŒë¼ë¯¸í„° â”€â”€
  lookback: 200                     # ë¶„ì„ êµ¬ê°„ (ë´‰ ìˆ˜)
  min_confidence: 30                # ì‹œê·¸ë„ ë°œìƒ ìµœì†Œ ì‹ ë¢°ë„ (%)
  confidence_boost: 0.10            # ë§¤ìˆ˜ í™•ì¸ ì‹œ trigger_confidence +10%
  confidence_penalty: 0.05          # ë§¤ë„ ê²½ê³  ì‹œ trigger_confidence -5%

# ============================================================
# v5.0 Sci-CoE í•©ì˜ ì—”ì§„ (Consensus Engine)
# ============================================================
# Sci-CoE ë…¼ë¬¸(2026.02.13)ì˜ ê¸°í•˜í•™ì  í•©ì˜ ê°œë… ì ìš©.
# ê¸°ì¡´ AND íŒŒì´í”„ë¼ì¸ì€ 100% ìœ ì§€, consensus_modeë¡œ í† ê¸€.
consensus_engine:
  enabled: true                       # í•©ì˜ ëª¨ë“œ í™œì„±í™”
  tau: 0.8                            # í•©ì˜ ì„ê³„ê°’ (80% ì´ìƒ í†µê³¼ = ê³ í•©ì˜)
  min_voters: 4                       # ìµœì†Œ íˆ¬í‘œ ë ˆì´ì–´ ìˆ˜
  grade_thresholds:
    strong: 0.6                       # >= 0.6: strong
    moderate: 0.4                     # >= 0.4: moderate
    weak: 0.2                         # >= 0.2: weak
                                      # < 0.2: reject
  anchor:
    enabled: true                     # ì•µì»¤ í•™ìŠµ í™œì„±í™”
    db_path: "data/anchors.json"      # ì•µì»¤ DB íŒŒì¼ ê²½ë¡œ
    min_success_pnl_pct: 3.0          # ì„±ê³µ ì‚¬ë¡€ ìµœì†Œ ìˆ˜ìµë¥  (%)
    min_failure_pnl_pct: -2.0         # ì‹¤íŒ¨ ì‚¬ë¡€ ìµœì†Œ ì†ì‹¤ë¥  (%)
    auto_update: true                 # ë°±í…ŒìŠ¤íŠ¸ í›„ ìë™ ì•µì»¤ ì—…ë°ì´íŠ¸

  bon_selector:
    enabled: true                     # BoN í”„ë¡œíŒŒì¼ ìë™ ì„ íƒ
    cache_ttl_bars: 20                # ìºì‹œ ìœ íš¨ ë´‰ ìˆ˜

# ============================================================
# v6.0 Martin Momentum (ë…¼ë¬¸: Richard J. Martin, 2023)
# ============================================================
# EMA2 í•„í„° + Dead Zone + Sigmoid í™œì„±í™” + ë³€ë™ì„± ì •ê·œí™”
martin_momentum:
  enabled: true
  n_fast: 8                           # Fast EMA ê¸°ê°„
  n_slow: 24                          # Slow EMA ê¸°ê°„
  epsilon: 0.05                       # Dead Zone ì„ê³„ê°’ (v7.1b: 0.3â†’0.05, í‰ê· íšŒê·€ ì „ëµê³¼ dead zone ì¶©ëŒ í•´ì†Œ)
  sigmoid_k: 5.0                      # Sigmoid ë¯¼ê°ë„
  min_confidence: 0.15                # ìµœì†Œ ì‹ ë¢°ë„ (v7.1: 0.3â†’0.15 ì™„í™”)
  vol_normalization:
    enabled: true
    target_sigma: 0.02                # ëª©í‘œ ì¼ê°„ ë³€ë™ì„± (2%)
    max_weight: 2.0                   # ìµœëŒ€ ë¹„ì¤‘ ë°°ìˆ˜
    min_weight: 0.3                   # ìµœì†Œ ë¹„ì¤‘ ë°°ìˆ˜
  optimal_hold:
    enabled: true
    max_days: 30                      # ìµœì  ë³´ìœ ê¸°ê°„ ìƒí•œ
    min_days: 5                       # ìµœì  ë³´ìœ ê¸°ê°„ í•˜í•œ

# ============================================================
# v6.0 RTTP ë‰´ìŠ¤ ì‹ í˜¸ (ë…¼ë¬¸: Hui et al., WWW '26)
# ============================================================
# ì†ŒìŠ¤ ê¶Œìœ„ ê°€ì¤‘ + ì¸ê²Œì´ì§€ë¨¼íŠ¸ ê¹Šì´ 5ë‹¨ê³„ + LLM í•©ì„±
rttp_news:
  enabled: true
  source_weights:
    DART: 1.0
    BLOOMBERG: 0.95
    BROKERAGE: 0.80
    NEWSPAPER: 0.70
    PORTAL: 0.50
    COMMUNITY: 0.15
  engagement_levels:
    L5_inst: 5.0                      # ê¸°ê´€ ìˆœë§¤ìˆ˜
    L4_volume: 3.5                    # ê±°ë˜ëŸ‰ ê¸‰ì¦
    L3_report: 2.0                    # ì¦ê¶Œì‚¬ ë¦¬í¬íŠ¸
    L2_search: 1.0                    # ê²€ìƒ‰ëŸ‰ ì¦ê°€
    L1_sns: 0.3                       # SNS/ì»¤ë®¤ë‹ˆí‹°
  recall_monitoring:
    enabled: true
    threshold: 0.5                    # Recall@K 50% ë¯¸ë§Œ â†’ ì¬ì¡°ì •
    window: 100                       # ëª¨ë‹ˆí„°ë§ ìœˆë„ìš°
  llm_synthesis:
    enabled: false                    # ê¸°ë³¸ ë¹„í™œì„±í™” (Claude API ë¹„ìš©)
    model: "claude-sonnet-4-5-20250929"
    max_beneficiaries: 5
    daily_call_limit: 100

# ============================================================
# v6.0 ê·¹í•œ ë³€ë™ì„± íƒì§€ (ë…¼ë¬¸: Alparslan & Kim, 2021)
# ============================================================
# ATR/ê±°ë˜ëŸ‰/ì¼ê°„ ë²”ìœ„ë¡œ ê·¹í•œ ë³€ë™ì„± íƒì§€ + ë°©í–¥ íŒë³„
extreme_volatility:
  enabled: true
  atr_ratio_threshold: 3.0           # í˜„ì¬ ATR / 60ì¼ í‰ê·  ATR
  vol_ratio_threshold: 5.0           # í˜„ì¬ ê±°ë˜ëŸ‰ / 60ì¼ í‰ê·  ê±°ë˜ëŸ‰
  daily_range_threshold: 10.0        # (ê³ ê°€-ì €ê°€)/ì¢…ê°€ * 100 (%)
  capitulation:
    min_down_days: 3                  # íˆ¬ë§¤ íŒì • ìµœì†Œ ì—°ì† í•˜ë½ì¼
    volume_climax_mult: 3.0           # ê±°ë˜ëŸ‰ í´ë¼ì´ë§¥ìŠ¤ ë°°ìˆ˜
    rsi_extreme: 20                   # RSI ê·¹ë‹¨ ê³¼ë§¤ë„
    min_score: 70                     # Capitulation ìµœì†Œ ì ìˆ˜
  allow_ambiguous: false              # ambiguous ë°©í–¥ ì‹œ ì‹œê·¸ë„ í—ˆìš© ì—¬ë¶€

# ============================================================
# v6.0 WaveLSFormer ì •ê·œí™” (ë…¼ë¬¸: WaveLSFormer, 2024)
# ============================================================
# ë¦¬ìŠ¤í¬ ì˜ˆì‚° ì •ê·œí™” + Sharpe ë³´ìœ ì ìˆ˜ + Peer ë¶„ì„
wavelsformer:
  risk_normalization:
    enabled: true
    target_daily_vol: 0.02              # ëª©í‘œ ì¼ê°„ ë³€ë™ì„± (2%)
    lookback: 60                        # ì‹¤í˜„ ë³€ë™ì„± ê³„ì‚° ê¸°ê°„
    max_scale: 2.0                      # ìµœëŒ€ í¬ì§€ì…˜ ìŠ¤ì¼€ì¼
    min_scale: 0.3                      # ìµœì†Œ í¬ì§€ì…˜ ìŠ¤ì¼€ì¼
  sharpe_hold_scoring:
    enabled: true
    bonus_threshold: 1.5                # Sharpe > 1.5 â†’ +3ì 
    moderate_threshold: 0.5             # Sharpe > 0.5 â†’ +1.5ì 
    penalty_threshold: -0.5             # Sharpe < -0.5 â†’ -2ì 
    lookback: 20                        # Sharpe ê³„ì‚° ê¸°ê°„
  peer_analysis:
    enabled: false                      # ê¸°ë³¸ ë¹„í™œì„±í™” (ì—°ì‚° ë¹„ìš©)

# ============================================================
# v7.0 TGCI (TRIX Golden Cross Indicator)
# ============================================================
tgci:
  golden_cross_pts: 35           # TRIX ê³¨ë“ í¬ë¡œìŠ¤ ê¸°ë³¸ ì ìˆ˜
  slope_bonus_max: 8             # ê¸°ìš¸ê¸° ë³´ë„ˆìŠ¤ ìµœëŒ€
  rsi_optimal_range: [40, 60]    # RSI ìµœì  ë§¤ìˆ˜ êµ¬ê°„
  volume_explosion_mult: 2.5     # ê±°ë˜ëŸ‰ í­ë°œ ê¸°ì¤€ ë°°ìˆ˜
  bb_overheat_threshold: 0.95    # ë³¼ë¦°ì € ê³¼ì—´ ì„ê³„ê°’
  setup_min_score: 55            # SETUP ì‹œê·¸ë„ ìµœì†Œ TGCI ì ìˆ˜

# ============================================================
# v7.0 Master Controller (ì„œë¸Œì‹œìŠ¤í…œ ê°€ì¤‘í•©ì‚°)
# ============================================================
master_controller:
  weights:
    pipeline: 0.40               # 7-Layer íŒŒì´í”„ë¼ì¸ í†µê³¼ ì ìˆ˜
    tgci: 0.20                   # TGCI ë…ë¦½ ì ìˆ˜
    smart_money: 0.15            # ìˆ˜ê¸‰ ë¶„ì„ ì ìˆ˜
    regime: 0.15                 # ë ˆì§ ì í•©ì„± ì ìˆ˜
    geometric: 0.10              # ê¸°í•˜í•™ ì—”ì§„ ì ìˆ˜
  thresholds:
    strong_buy: 75               # STRONG_BUY ìµœì†Œ ì ìˆ˜
    buy_conservative: 65         # BUY(ë³´ìˆ˜ì ) ìµœì†Œ ì ìˆ˜
    buy_aggressive: 50           # BUY(ê³µê²©ì ) ìµœì†Œ ì ìˆ˜
    watch: 40                    # WATCH ìµœì†Œ ì ìˆ˜
  min_contributing_systems:
    conservative: 3              # ë³´ìˆ˜ì  ì§„ì… ìµœì†Œ ì„œë¸Œì‹œìŠ¤í…œ ìˆ˜
    aggressive: 2                # ê³µê²©ì  ì§„ì… ìµœì†Œ ì„œë¸Œì‹œìŠ¤í…œ ìˆ˜

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# v8.3 ê³µë§¤ë„ ì²´ì œ ìº˜ë¦°ë” + Regime Profile
# "ê³µë§¤ë„ ì¬ê°œ/ê¸ˆì§€ì— ë”°ë¼ ì „ëµ íŒŒë¼ë¯¸í„°ë¥¼ ë™ì  ì¡°ì •"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
short_selling_calendar:
  # status: "active" = ì •ìƒ ê³µë§¤ë„, "banned" = ê¸ˆì§€, "reopened" = ê¸ˆì§€ í›„ ì¬ê°œì¥
  - { start: "2019-01-01", end: "2020-03-15", status: "active" }
  - { start: "2020-03-16", end: "2021-05-02", status: "banned" }    # COVID ê¸ˆì§€
  - { start: "2021-05-03", end: "2023-11-05", status: "active" }
  - { start: "2023-11-06", end: "2025-03-30", status: "banned" }    # ì „ë©´ ê¸ˆì§€
  - { start: "2025-03-31", end: "2099-12-31", status: "reopened" }   # ì¬ê°œì¥ (ë³„ë„ í”„ë¡œíŒŒì¼)

regime_profiles:
  # ì •ìƒ ê³µë§¤ë„ ì‹œ (ê³¼ê±° ê²€ì¦ëœ íŒŒë¼ë¯¸í„°)
  short_selling_active:
    max_positions_scale: 0.6        # max_positions Ã— 0.6 (5â†’3)
    min_rr_ratio: 2.0               # ì†ìµë¹„ í•˜í•œ ìƒí–¥ (1.5â†’2.0)
    position_scale_mult: 0.7        # í¬ì§€ì…˜ í¬ê¸° 70%
    stop_loss_scale: 0.8            # ì†ì ˆ 20% íƒ€ì´íŠ¸
    max_hold_days_scale: 0.6        # ìµœëŒ€ ë³´ìœ ì¼ ì¶•ì†Œ (30â†’18)
    sa_floor: 0.30                  # SA floor ë‚®ì¶¤ â†’ hostile ë„ë‹¬ ê°€ëŠ¥
    min_regime_scale: 0.0           # hostileë§Œ ì°¨ë‹¨ (ì •ìƒì¥ caution ì§„ì… í—ˆìš©)

  # ê³µë§¤ë„ ê¸ˆì§€ ì‹œ (ê¸°ë³¸ íŒŒë¼ë¯¸í„° ìœ ì§€)
  short_selling_banned:
    max_positions_scale: 1.0
    min_rr_ratio: 1.5
    position_scale_mult: 1.0
    stop_loss_scale: 1.0
    max_hold_days_scale: 1.0
    sa_floor: 0.55                  # ê¸°ì¡´ ë†’ì€ floor ìœ ì§€
    min_regime_scale: 0.0           # hostileë§Œ ì°¨ë‹¨

  # ì¬ê°œì¥ (ê¸ˆì§€ í›„ ê³µë§¤ë„ ì¬ê°œ â€” ìµœê³  ë°©ì–´ ëª¨ë“œ)
  short_selling_reopened:
    max_positions_scale: 0.6        # max_positions Ã— 0.6 (5â†’3)
    min_rr_ratio: 2.0               # ì†ìµë¹„ í•˜í•œ ìƒí–¥
    position_scale_mult: 0.7        # í¬ì§€ì…˜ í¬ê¸° 70%
    stop_loss_scale: 0.8            # ì†ì ˆ 20% íƒ€ì´íŠ¸
    max_hold_days_scale: 0.6        # ìµœëŒ€ ë³´ìœ ì¼ ì¶•ì†Œ
    sa_floor: 0.30                  # hostile ë„ë‹¬ ê°€ëŠ¥
    min_regime_scale: 0.75          # neutral ì´ìƒë§Œ ì§„ì… (caution ì°¨ë‹¨)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# v8.2 Market Regime Gate (7D ì‹œì¥ ì²´ì œ ê°ì§€)
# "ì§€ê¸ˆì´ ìš°ë¦¬ ì‹œìŠ¤í…œì´ ì‘ë™í•˜ëŠ” ì‹œì¥ì¸ê°€?"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
regime_gate:
  enabled: true
  lookback: 20                     # ì²´ì œ íŒë‹¨ ê¸°ë³¸ lookback (ì¼)

  # 1. Market Breadth (ì¶”ì„¸ ì •ë ¬ ì¢…ëª© ë¹„ìœ¨)
  breadth:
    favorable_pct: 0.55            # 55%+ ì¢…ëª© ì¶”ì„¸ ì •ë ¬ â†’ favorable
    hostile_pct: 0.35              # 35%- â†’ hostile

  # 2. Foreign Flow (ì™¸êµ­ì¸ ìˆ˜ê¸‰ ë°©í–¥)
  foreign_flow:
    lookback: 20                   # ì™¸êµ­ì¸ ë°©í–¥ íŒë‹¨ ê¸°ê°„
    strong_buy_ratio: 0.60         # 60%+ ì¢…ëª© ì™¸êµ­ì¸ ìˆœë§¤ìˆ˜ â†’ buy day
    weak_sell_ratio: 0.40          # 40%- â†’ sell day

  # 3. Volatility Regime (ë³€ë™ì„± í™˜ê²½)
  volatility:
    short_lookback: 10             # ë‹¨ê¸° ë³€ë™ì„± ê¸°ê°„
    long_lookback: 60              # ì¥ê¸° ë³€ë™ì„± ê¸°ì¤€
    spike_threshold: 1.5           # ë‹¨ê¸°/ì¥ê¸° ë¹„ìœ¨ 1.5x+ â†’ hostile

  # 4. Self-Adaptive (ê³±ì…ˆ ê³„ìˆ˜ â€” ìµœê·¼ ê±°ë˜ ì„±ê³µë¥ )
  self_adaptive:
    window: 15                     # ìµœê·¼ 15ê±°ë˜ ë¡¤ë§ (ë¹ ë¥¸ ë°˜ì‘/íšŒë³µ)
    min_trades: 8                  # 8ê±´ ì´ìƒ ìŒ“ì—¬ì•¼ í™œì„±í™”
    floor: 0.55                    # SA=0ì¼ ë•Œ baseì˜ 55% ë°˜ì˜ (caution ìœ ì§€, ì‚¬ë§ë‚˜ì„  ë°©ì§€)
    hostile_winrate: 0.25          # 25% ì´í•˜ â†’ SA=0.0 (Ã—0.30)
    caution_winrate: 0.35          # 35% ì´í•˜ â†’ caution ë°©í–¥
    neutral_winrate: 0.50          # 50% ì´í•˜ â†’ neutral ë°©í–¥

  # ì²´ì œ íŒì • ì„ê³„ê°’ (composite = base Ã— sa_mult, 0~3 ë²”ìœ„)
  thresholds:
    favorable: 2.2                 # >= 2.2: ì „ì²´ í¬ì§€ì…˜ (scale=1.0)
    neutral: 1.5                   # >= 1.5: 75% í¬ì§€ì…˜
    caution: 0.8                   # >= 0.8: 50% í¬ì§€ì…˜
                                   # < 0.8: ì‹ ê·œ ì§„ì… ì°¨ë‹¨ (scale=0.0)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# v8.1 Gate + Score Hybrid Pipeline (Tuned)
# "í¬ë¬¼ì„  ì´ˆì ì— ì§„ì…í•˜ì—¬ ì¶”ì„¸ë¥¼ ë¨¹ëŠ”ë‹¤"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
v8_hybrid:
  enabled: true  # trueë©´ v8 íŒŒì´í”„ë¼ì¸, falseë©´ ê¸°ì¡´ v7

  # â”€â”€â”€ Phase 1: Hard Gates (AND) â”€â”€â”€
  gates:
    trend:
      ma_fast: 60                # MA60 > MA120 (ì¤‘ê¸° > ì¥ê¸°)
      ma_slow: 120
      adx_min: 18                # v8.0 ì›ë³¸ ìœ ì§€ (ê²€ì¦ëœ í•„í„°)
    pullback:
      min_atr_pullback: 0.8      # v8.0 ì›ë³¸ ìœ ì§€
      max_atr_pullback: 4.0      # v8.0 ì›ë³¸ ìœ ì§€
      high_lookback_days: 20
    overheat:
      max_52w_ratio: 0.92        # v8.0 ì›ë³¸ ìœ ì§€

  # â”€â”€â”€ Phase 2: Scoring Engine (ê°€ì¤‘í•©) â”€â”€â”€
  scoring:
    weights:
      energy_depletion: 0.30     # S1: ë§¤ë„ ì—ë„ˆì§€ ì†Œì§„
      valuation: 0.20            # S2: ë°¸ë¥˜ì—ì´ì…˜
      ou_reversion: 0.20         # S3: OU í‰ê· íšŒê·€
      momentum_decel: 0.15       # S4: ëª¨ë©˜í…€ ê°ì† (martin_dead_zone ëŒ€ì²´)
      smart_money: 0.15          # S5: ìˆ˜ê¸‰/ìŠ¤ë§ˆíŠ¸ë¨¸ë‹ˆ

    energy:
      rsi_optimal_center: 45
      rsi_optimal_range: [38, 52]
      vol_ratio_threshold: 0.7   # 5MA/20MA < 0.7 â†’ ê´€ì‹¬ ì² ìˆ˜
      bb_position_optimal: [0.05, 0.30]

    valuation:
      per_discount_threshold: 0.8
      pbr_percentile_good: 30
      forward_per_discount: 0.85

    ou:
      z_score_optimal: [-2.5, -1.0]
      z_score_weak: [-1.0, -0.5]
      half_life_fast: [3, 15]
      half_life_medium: [15, 30]
      theta_strong: 0.05

    momentum:
      slope_window_long: 20
      slope_window_short: 5

    smart_money:
      obv_trend_days: 5
      drs_safe_threshold: 0.3
      drs_neutral_threshold: 0.5

    grade_cutoffs:
      A: 0.65                    # í’€ ì‚¬ì´ì¦ˆ ì§„ì… (fundamental ë¯¸ì¡´ì¬ ë³´ì •)
      B: 0.50                    # í•˜í”„ ì‚¬ì´ì¦ˆ ì§„ì…
      C: 0.35                    # ì›Œì¹˜ë¦¬ìŠ¤íŠ¸ë§Œ (ì§„ì… ë¶ˆê°€)

  # â”€â”€â”€ Phase 3: Triggers (OR) â”€â”€â”€
  triggers:
    volume_rsi:
      vol_multiplier: 1.5
      rsi_threshold: 45

  # â”€â”€â”€ Position Sizing â”€â”€â”€
  position:
    A_grade_pct: 0.20            # Aë“±ê¸‰: ìë³¸ì˜ 20%
    B_grade_pct: 0.10            # Bë“±ê¸‰: ìë³¸ì˜ 10%
    stop_loss_atr: 2.0           # ì†ì ˆ: -2 ATR
    target_atr_A: 5.0            # Aë“±ê¸‰ íƒ€ê²Ÿ: +5 ATR
    target_atr_B: 3.5            # Bë“±ê¸‰ íƒ€ê²Ÿ: +3.5 ATR
    min_rr_ratio: 1.5            # ìµœì†Œ ì†ìµë¹„

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ìˆ˜ê¸‰ ì´ë©´ ë°ì´í„° ë ˆì´ì–´ (6ê°œ)
# "ê°€ê²©ì´ ì˜¤ë¥´ëŠ” ì´ìœ ê°€ ì§„ì§œì¸ì§€ ê°€ì§œì¸ì§€ êµ¬ë¶„"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
supply_demand:
  enabled: true
  collection_time: "16:30"          # ì¥ë§ˆê° í›„ ìˆ˜ì§‘ ì‹œê°

  # â”€â”€ L1: ê³µë§¤ë„ â”€â”€
  short_selling:
    spike_threshold: 2.0            # 40ì¼ í‰ê·  ëŒ€ë¹„ ë°°ìˆ˜ â†’ ìœ„í—˜
    balance_danger_pct: 3.0         # ìƒì¥ì£¼ì‹ìˆ˜ ëŒ€ë¹„ 3%+ â†’ ëª¨ë‹ˆí„°ë§
    lending_increase_warn: 20       # ëŒ€ì°¨ì”ê³  5ì¼ ë³€í™”ìœ¨ 20%+ â†’ ê²½ê³ 
    overheated_halt: true           # ê³¼ì—´ì¢…ëª© ì§€ì • ì‹œ ìë™ë§¤ë§¤ ì¤‘ë‹¨

  # â”€â”€ L3: ì²´ê²°ê°•ë„ (Phase 2) â”€â”€
  execution:
    strength_weak: 50               # ì²´ê²°ê°•ë„ 50 ë¯¸ë§Œ â†’ ë§¤ë„ì„¸ ìš°ìœ„
    large_trade_multiple: 10        # í‰ê· ì˜ 10ë°°+ â†’ ëŒ€ëŸ‰ ì²´ê²°

  # â”€â”€ L5: ê¸°ê´€/ì™¸ì¸ ìˆ˜ê¸‰ â”€â”€
  investor_flow:
    foreign_consecutive_strong: 5   # 5ì¼+ ì—°ì† ìˆœë§¤ìˆ˜ â†’ ì¶”ì„¸ í˜•ì„±
    foreign_consecutive_weak: 3     # 3ì¼+ â†’ ê´€ì‹¬
    institution_20d_positive: true  # ê¸°ê´€ 20ì¼ ëˆ„ì  ì–‘ì „í™˜ â†’ ë§¤ì§‘

  # â”€â”€ í•¨ì •ë¥  v2.0 ê°€ì¤‘ì¹˜ â”€â”€
  trap_weights:
    crowd_heat: 0.25                # êµ°ì¤‘ ê³¼ì—´ë„
    short_risk: 0.20                # ê³µë§¤ë„ ìœ„í—˜ë„
    spoofing: 0.20                  # í—ˆìˆ˜í˜¸ê°€ ë¹ˆë„ (Phase 3)
    execution_reverse: 0.15         # ì²´ê²°ê°•ë„ ì—­ì „
    wash_trade: 0.10                # ìì „ê±°ë˜ ì˜ì‹¬
    program_pressure: 0.10          # í”„ë¡œê·¸ë¨ ë§¤ë„ ì••ë ¥

  # â”€â”€ êµ¬í˜„ ë¡œë“œë§µ â”€â”€
  # Phase 1 (ì¦‰ì‹œ): pykrx ê³µë§¤ë„ + ìˆ˜ê¸‰ â†’ L1, L5
  # Phase 2 (2~3ì£¼): KIS ì‹¤ì‹œê°„ ì²´ê²°ê°•ë„ + í”„ë¡œê·¸ë¨ â†’ L3, L4
  # Phase 3 (1~2ê°œì›”): í˜¸ê°€ì°½ í—ˆìˆ˜í˜¸ê°€ + ì˜µì…˜ â†’ L2, L6

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 1: ì¥ì¤‘ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
intraday_monitor:
  enabled: true

  # â”€â”€â”€ ìˆ˜ì§‘ ì£¼ê¸° â”€â”€â”€
  tick_interval_sec: 60          # 1ë¶„: ë³´ìœ ì¢…ëª© í˜„ì¬ê°€ í‹±
  candle_interval_min: 5         # 5ë¶„: 5ë¶„ë´‰ + ì‹œì¥ì§€ìˆ˜
  flow_interval_min: 10          # 10ë¶„: íˆ¬ìììˆ˜ê¸‰ + ì—…ì¢…ì‹œì„¸

  # â”€â”€â”€ ì‹œì¥ ì‹œê°„ â”€â”€â”€
  market_hours:
    premarket_start: "08:30"     # í”„ë¦¬ë§ˆì¼“ (ì‹œì¥ì§€ìˆ˜ë§Œ)
    regular_start: "09:00"       # ì •ê·œì¥ ì‹œì‘
    regular_end: "15:30"         # ì •ê·œì¥ ë§ˆê°
    closing_snapshot: "15:35"    # ë§ˆê° í™•ì • ë°ì´í„°

  # â”€â”€â”€ DB ì„¤ì • â”€â”€â”€
  db_path: "data/intraday.db"    # SQLite íŒŒì¼ ê²½ë¡œ
  cleanup_days: 30               # 30ì¼ ì´ì „ ë°ì´í„° ìë™ ì‚­ì œ

  # â”€â”€â”€ API Rate Limit â”€â”€â”€
  rate_limit:
    max_calls_per_sec: 16        # KIS API ì´ˆë‹¹ ìµœëŒ€ í˜¸ì¶œ
    min_interval_ms: 60          # í˜¸ì¶œ ê°„ ìµœì†Œ ê°„ê²© (ms)

  # â”€â”€â”€ Phase 2: ìƒí™©ë³´ê³ ì„œ â”€â”€â”€
  situation_report:
    interval_min: 30               # ì •ê¸° ë³´ê³  ì£¼ê¸° (ë¶„)
    emergency_threshold: 0.03      # 3% ê¸‰ë³€ ì‹œ ê¸´ê¸‰ ë³´ê³ 
    closing_time: "15:35"          # ë§ˆê° ë³´ê³ ì„œ ìƒì„± ì‹œê°

  # â”€â”€â”€ Phase 3: AI íŒë‹¨ (ì˜ˆì •) â”€â”€â”€
  # ai_judgment:
  #   model: "claude-sonnet-4-5-20250929"
  #   max_daily_calls: 50        # ì¼ì¼ ìµœëŒ€ í˜¸ì¶œ
  #   regular_calls: 30          # ì •ê¸° íŒë‹¨ (6íšŒ/ì¢…ëª© Ã— 5ì¢…ëª©)
  #   emergency_budget: 20       # ê¸´ê¸‰ íŒë‹¨ ì˜ˆì‚°

  # â”€â”€â”€ Phase 4: í…”ë ˆê·¸ë¨ ì•Œë¦¼ (ì˜ˆì •) â”€â”€â”€
  # telegram_alerts:
  #   green_interval_min: 240    # ì •ê¸° ë³´ê³  (4ì‹œê°„)
  #   yellow_immediate: true     # ì£¼ì˜ ì¦‰ì‹œ ì „ì†¡
  #   red_immediate: true        # ë§¤ë„ ì¦‰ì‹œ ì „ì†¡
  #   blue_immediate: true       # ì¶”ë§¤ ì¦‰ì‹œ ì „ì†¡
